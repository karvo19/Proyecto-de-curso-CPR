clear all;
syms q1 qd1 qdd1 q2 qd2 qdd2 q3 qd3 qdd3 g real

Ma = [
[ (30612509037519171*cos(2*q2 + q3))/22517998136852480 + (7923634914903717*cos(2*q2))/4503599627370496 + (7145278848525341*cos(2*q2 + 2*q3))/18014398509481984 + (30612509037519171*cos(q3))/22517998136852480 + 39181235098854191/18014398509481984,                                                                                  0,                                                                                   0];
[                                                                                                                                                                                                                                                  0, (30612509037519171*cos(q3))/9007199254740992 + 97924626708858385/18014398509481984, (30612509037519171*cos(q3))/18014398509481984 + 17909359017493675/18014398509481984];
[                                                                                                                                                                                                                                                  0,  (4373215576788453*cos(q3))/2251799813685248 + 17909359017493675/15762598695796736,                                             1167023812028605325/1008806316530991104]];
 
Va = [
                    -(qd1*(3961817457451858500*qd2*sin(2*q2) + 893159856065667625*qd2*sin(2*q2 + 2*q3) + 893159856065667625*qd3*sin(2*q2 + 2*q3) + 1530625451875958550*qd3*sin(q3) + 3061250903751917100*qd2*sin(2*q2 + q3) + 1530625451875958550*qd3*sin(2*q2 + q3) - 27021597764222976))/1125899906842624000;
 (17*qd2)/800 - (30612509037519171*qd3^2*sin(q3))/18014398509481984 + (30612509037519171*qd1^2*sin(2*q2 + q3))/18014398509481984 + (39618174574518585*qd1^2*sin(2*q2))/18014398509481984 + (35726394242626705*qd1^2*sin(2*q2 + 2*q3))/72057594037927936 - (30612509037519171*qd2*qd3*sin(q3))/9007199254740992;
                                                                  (3*qd3)/70 + (4373215576788453*qd1^2*sin(q3))/4503599627370496 + (4373215576788453*qd2^2*sin(q3))/2251799813685248 + (4373215576788453*qd1^2*sin(2*q2 + q3))/4503599627370496 + (35726394242626705*qd1^2*sin(2*q2 + 2*q3))/63050394783186944];
 
Ga = [
                                                                                                    0;
 g*((21866077883942265*cos(q2 + q3))/9007199254740992 + (16399558412956785*cos(q2))/2251799813685248);
                                                  (21866077883942265*g*cos(q2 + q3))/7881299347898368];
 
                                              
                                              
% Modelo estimado para el diseño de controladores:
% De M nos quedamos con los terminos de la diagonal. Cogemos el maximo.
% M11 = simplify(Ma(1,1))
% M22 = simplify(Ma(2,2))
% M33 = simplify(Ma(3,3))

% M11 = vpa(7653127259379793/5629499534213120 + 7923634914903717/4503599627370496 + 7145278848525341/18014398509481984 + 7653127259379793/5629499534213120 + 2448827193678387/1125899906842624)
% M22 = vpa(7653127259379793/2251799813685248 + 6120289169303649/1125899906842624)
% M33 = vpa(162810241633455/140737488355328)

M11 = 7.049975495999897923127264220966;
M22 = 8.8345799999998551044200212345459;
M33 = 1.1568363449999807812673680018634;

% De V eliminamos los terminos cuadráticos de qd y los senos y cosenos
% V1 = vpa(27021597764222976/1125899906842624000*qd1)
% V2 = vpa(17/800*qd2)
% V3 = vpa(3/70*qd3)

V1 = 0.024*qd1;
V2 = 0.02125*qd2;
V3 = 0.042857142857142857142857142857143*qd3;